Index: msvc/Build.win32.readme
===================================================================
--- msvc/Build.win32.readme	(revision 29482)
+++ msvc/Build.win32.readme	(working copy)
@@ -1,5 +1,86 @@
-The following are notes on building enchant and its dependencies using MSVC 2005.
+The following are notes on building enchant (1.6) and its dependencies using MSVC 2008 (by John Thomson).
+Sorry they are rather rough, but it's the best I can do and should be of some help.

+Enchant depends on glib. Based on Eric's comments I think it may be important to build glib using the same exact C runtime library,
+though I have not confirmed this.
+
+I started by downloading glib-2.26.1.tar.bz2 from http://www.gtk.org/download-windows.html and expand twice with stuffit (to d:\try2\glib).
+Open D:\try2\glib\glib-2.26.1\build\win32\vs9\glib.sln in Visual Studio.
+
+Be sure to follow the instructions in  glib-2.26.1\build\win32\vs9\README.txt, which describes how to set up the build and dependencies.
+
+Even after doing that, this solution, as of 2.26.1, has some problems. The Windows build process does not know how to make some .h files
+from .h.in ones. For example, glibconfig.h.win32.in needs to be copied to glibconfig.h.win32.
+
+There is a bug in the prebuild event, at least for glib and I think also for some other modules. Change the lines for glibconfig.h to
+
+if exist ..\..\..\glib\glibconfig.h goto DONE_GLIBCONFIG_H
+copy ..\..\..\glib\glibconfig.h.win32 ..\..\..\glib\glibconfig.h
+
+Now it at least tries to build the C++ files.
+
+Still 12 build errors.
+define G_OS_WIN32 as project pre-processor define fixes many.
+modify gtimer.c not to include sys/time.h if G_OS_WIN32 is defined fixes another (and many warnings).
+
+Now remaining problems are missing files in glib\pcre
+Files
+'..\..\..\glib\pcre\pcre_version.c'
+'..\..\..\glib\pcre\pcre_valid_utf8.c'
+'..\..\..\glib\pcre\pcre_refcount.c
+ '..\..\..\glib\pcre\pcre_maketables.c'
+'..\..\..\glib\pcre\pcre_info.c'
+
+Simply removing them from the project leads to a successful build as far as I can tell.
+(I note that these files are not listed in the pcre Makefile.am; possibly they have been removed but the Windows build was not updated?)
+
+Outputs are now in D:\try2\glib\glib-2.26.1\build\win32\vs9\Release\Win32\bin.
+
+So much for glib. Now for building Enchant. Used TortoiseSvn to get source from http://svn.abisource.com/enchant/trunk to d:\Enchant.
+The VS project in the repository when I started was for VS2005 (I think I used revision 29482).
+I opened it and let it update to a VS 2008 project.
+
+Copied all the .h files from D:\try2\glib\glib-2.26.1\glib to D:\Enchant\lib\glib\include\glib-2.0.
+(It only obviously needs glib.h, but that includes all or most of the rest.)
+Then had to move all but glib.h itself into a glib subdirectory.
+glibconfig apparently needs to be back up in glib-2.0.
+
+Copy gmodule.h from D:\try2\glib\glib-2.26.1\gmodule to D:\Enchant\lib\glib\include\glib-2.0
+
+In project properties, defined ENCHANT_VERSION_STRING to be \"1.6\". (This is probably not the ideal way to handle this.)
+
+Resource file libenchant.rc cannot be found anywhere. Tried removing it.
+Now everything compiles (but doesn't link yet).
+However, libenchant.rc produces the "details" that a DLL should have in its properties in Windows explorer.
+Discovered it is supposed to be generateed from libenchant.rc.in. Generated one by hand making appropriate version number substitutions.
+This seems to work.
+
+Copy glib-2.0.lib (as glib-2.0-vs9.lib) and gmodule-2.0.lib (as gmodule-2.0-vs9.lib) from D:\try2\glib\glib-2.26.1\build\win32\vs9\Release\Win32\bin to D:\Enchant\lib\glib\release.
+Change Include files to use vs9 rather than vs8.
+
+At this point, we seem to have a good build of libenchant.dll.
+
+However the broker was still not able to make a dictionary based on the myspell stuff. Seems we need to build a compatible myspell backend.
+Did that with minor fixes to project #defines and manually added .rc to give version number.
+
+Getting unit tests working
+- Downloaded unittest-cpp-1.4.zip from http://sourceforge.net/projects/unittest-cpp/files/UnitTest%2B%2B/1.4/unittest-cpp-1.4.zip/download. Unzip to D:\Enchant\lib.
+- Change lib file in two projects from vs8 to vs9
+- in EnchantBrokerTestFixture.h, add
+#define testResults_ (*(UnitTest::CurrentTest::Results())) ...that doesn't seem right, most of the tests using that fail. But it got it to compile and let me run the others.
+Got the required  UnitTest++.vsnet2005.lib... by building the unitTest++ solution.
+
+At this point I could run some unit tests. I didn't get them working all the way.
+
+Gotcha: if you run the enchant user tests (which I only partly got working), they set an enchant data directory in the registry, which breaks the FW unit test the second and later times it is run, because it can't delete the temp dictionary.
+
+Sorry this is so incomplete but it's as far as I got.
+
+----------------------------------
+
+The following are notes on building enchant (1.3?) and its dependencies using MSVC 2005 (by a former author, I think Eric Albright).
+Some of the comments here may still be relevant for 1.6; I'm keeping the information because I don't understand it entirely.
+
 Enchant depends on glib (http://www.gtk.org/)
 Glib depends on libiconv (http://www.gnu.org/software/libiconv/)
			  and libintl (http://www.gnu.org/software/gettext/)
Index: msvc/enchant-lsmod.vcproj
===================================================================
--- msvc/enchant-lsmod.vcproj	(revision 29482)
+++ msvc/enchant-lsmod.vcproj	(working copy)
@@ -1,11 +1,12 @@
 <?xml version="1.0" encoding="Windows-1252"?>
 <VisualStudioProject
	ProjectType="Visual C++"
-	Version="8.00"
+	Version="9.00"
	Name="enchant-lsmod"
	ProjectGUID="{8B0F0A17-CEB4-42DF-B97E-375C60DB31E7}"
	RootNamespace="enchantlsmod"
	Keyword="Win32Proj"
+	TargetFrameworkVersion="131072"
	>
	<Platforms>
		<Platform
@@ -66,6 +67,8 @@
				AdditionalLibraryDirectories="&quot;$(SolutionDir)..\lib\glib\$(ConfigurationName)&quot;"
				GenerateDebugInformation="true"
				SubSystem="1"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -87,9 +90,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
			/>
		</Configuration>
@@ -144,6 +144,8 @@
				SubSystem="1"
				OptimizeReferences="2"
				EnableCOMDATFolding="2"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -165,9 +167,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
			/>
		</Configuration>
Index: msvc/enchant.sln
===================================================================
--- msvc/enchant.sln	(revision 29482)
+++ msvc/enchant.sln	(working copy)
@@ -1,149 +1,81 @@
-Microsoft Visual Studio Solution File, Format Version 9.00
-# Visual Studio 2005
-Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "libenchant", "libenchant.vcproj", "{E0DB6274-F44C-48E6-AE30-C00D59864569}"
-	ProjectSection(WebsiteProperties) = preProject
-		Debug.AspNetCompiler.Debug = "True"
-		Release.AspNetCompiler.Debug = "False"
+Microsoft Visual Studio Solution File, Format Version 10.00
+# Visual Studio 2008
+Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "Readme", "Readme", "{A8947D89-B8C1-479C-8C2B-E0444D624E0E}"
+	ProjectSection(SolutionItems) = preProject
+		Build.win32.readme = Build.win32.readme
	EndProjectSection
 EndProject
+Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "libenchant", "libenchant.vcproj", "{E0DB6274-F44C-48E6-AE30-C00D59864569}"
+EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "libenchant_aspell", "libenchant_aspell.vcproj", "{E948850F-C9DA-4824-876D-4FE97B88E79F}"
-	ProjectSection(WebsiteProperties) = preProject
-		Debug.AspNetCompiler.Debug = "True"
-		Release.AspNetCompiler.Debug = "False"
-	EndProjectSection
	ProjectSection(ProjectDependencies) = postProject
		{E0DB6274-F44C-48E6-AE30-C00D59864569} = {E0DB6274-F44C-48E6-AE30-C00D59864569}
	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "libenchant_hspell", "libenchant_hspell.vcproj", "{AA6839DF-19CB-49DD-8258-ABB86B5B0428}"
-	ProjectSection(WebsiteProperties) = preProject
-		Debug.AspNetCompiler.Debug = "True"
-		Release.AspNetCompiler.Debug = "False"
-	EndProjectSection
	ProjectSection(ProjectDependencies) = postProject
		{E0DB6274-F44C-48E6-AE30-C00D59864569} = {E0DB6274-F44C-48E6-AE30-C00D59864569}
	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "libenchant_uspell", "libenchant_uspell.vcproj", "{6FA58A42-075E-4671-BBB4-F7AA8061F839}"
-	ProjectSection(WebsiteProperties) = preProject
-		Debug.AspNetCompiler.Debug = "True"
-		Release.AspNetCompiler.Debug = "False"
-	EndProjectSection
	ProjectSection(ProjectDependencies) = postProject
		{E0DB6274-F44C-48E6-AE30-C00D59864569} = {E0DB6274-F44C-48E6-AE30-C00D59864569}
	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "libenchant_ispell", "libenchant_ispell.vcproj", "{5DC9EE15-B080-4964-96CC-1BDC90BB873A}"
-	ProjectSection(WebsiteProperties) = preProject
-		Debug.AspNetCompiler.Debug = "True"
-		Release.AspNetCompiler.Debug = "False"
-	EndProjectSection
	ProjectSection(ProjectDependencies) = postProject
		{E0DB6274-F44C-48E6-AE30-C00D59864569} = {E0DB6274-F44C-48E6-AE30-C00D59864569}
	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "libenchant_myspell", "libenchant_myspell.vcproj", "{70927F4C-0446-4EF3-9F65-FA78AC210506}"
-	ProjectSection(WebsiteProperties) = preProject
-		Debug.AspNetCompiler.Debug = "True"
-		Release.AspNetCompiler.Debug = "False"
-	EndProjectSection
	ProjectSection(ProjectDependencies) = postProject
		{E0DB6274-F44C-48E6-AE30-C00D59864569} = {E0DB6274-F44C-48E6-AE30-C00D59864569}
	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "libenchant_voikko", "libenchant_voikko.vcproj", "{5612C360-309B-4E73-8512-6A1265590B90}"
-	ProjectSection(WebsiteProperties) = preProject
-		Debug.AspNetCompiler.Debug = "True"
-		Release.AspNetCompiler.Debug = "False"
-	EndProjectSection
	ProjectSection(ProjectDependencies) = postProject
		{E0DB6274-F44C-48E6-AE30-C00D59864569} = {E0DB6274-F44C-48E6-AE30-C00D59864569}
	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "libenchant_zemberek", "libenchant_zemberek.vcproj", "{B35929B8-374C-442B-A0F5-494AD69EDE1A}"
-	ProjectSection(WebsiteProperties) = preProject
-		Debug.AspNetCompiler.Debug = "True"
-		Release.AspNetCompiler.Debug = "False"
-	EndProjectSection
	ProjectSection(ProjectDependencies) = postProject
		{E0DB6274-F44C-48E6-AE30-C00D59864569} = {E0DB6274-F44C-48E6-AE30-C00D59864569}
	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "test-enchant", "test-enchant.vcproj", "{3CC7AE6D-FEA3-4EB3-98FA-8AB038541411}"
-	ProjectSection(WebsiteProperties) = preProject
-		Debug.AspNetCompiler.Debug = "True"
-		Release.AspNetCompiler.Debug = "False"
-	EndProjectSection
	ProjectSection(ProjectDependencies) = postProject
		{E0DB6274-F44C-48E6-AE30-C00D59864569} = {E0DB6274-F44C-48E6-AE30-C00D59864569}
	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "test-enchantxx", "test-enchantxx.vcproj", "{001DB089-3C83-4384-BB2B-1FE37D091B04}"
-	ProjectSection(WebsiteProperties) = preProject
-		Debug.AspNetCompiler.Debug = "True"
-		Release.AspNetCompiler.Debug = "False"
-	EndProjectSection
	ProjectSection(ProjectDependencies) = postProject
		{E0DB6274-F44C-48E6-AE30-C00D59864569} = {E0DB6274-F44C-48E6-AE30-C00D59864569}
	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "enchant", "enchant.vcproj", "{FE3CD71B-7742-46DD-AAE9-3CCAA110B4DB}"
-	ProjectSection(WebsiteProperties) = preProject
-		Debug.AspNetCompiler.Debug = "True"
-		Release.AspNetCompiler.Debug = "False"
-	EndProjectSection
	ProjectSection(ProjectDependencies) = postProject
		{E0DB6274-F44C-48E6-AE30-C00D59864569} = {E0DB6274-F44C-48E6-AE30-C00D59864569}
	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "enchant-lsmod", "enchant-lsmod.vcproj", "{8B0F0A17-CEB4-42DF-B97E-375C60DB31E7}"
-	ProjectSection(WebsiteProperties) = preProject
-		Debug.AspNetCompiler.Debug = "True"
-		Release.AspNetCompiler.Debug = "False"
-	EndProjectSection
	ProjectSection(ProjectDependencies) = postProject
		{E0DB6274-F44C-48E6-AE30-C00D59864569} = {E0DB6274-F44C-48E6-AE30-C00D59864569}
	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "unittest-enchant", "unittest-enchant.vcproj", "{44BF74D0-5462-4A3B-8768-61E0DEF81B7B}"
-	ProjectSection(WebsiteProperties) = preProject
-		Debug.AspNetCompiler.Debug = "True"
-		Release.AspNetCompiler.Debug = "False"
-	EndProjectSection
	ProjectSection(ProjectDependencies) = postProject
		{E0DB6274-F44C-48E6-AE30-C00D59864569} = {E0DB6274-F44C-48E6-AE30-C00D59864569}
		{A8F1C09A-A244-441B-804C-635106305056} = {A8F1C09A-A244-441B-804C-635106305056}
	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "libenchant_mock_provider", "libenchant_mock_provider.vcproj", "{A8F1C09A-A244-441B-804C-635106305056}"
-	ProjectSection(WebsiteProperties) = preProject
-		Debug.AspNetCompiler.Debug = "True"
-		Release.AspNetCompiler.Debug = "False"
-	EndProjectSection
 EndProject
-Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "Readme", "Readme", "{A8947D89-B8C1-479C-8C2B-E0444D624E0E}"
-	ProjectSection(WebsiteProperties) = preProject
-		Debug.AspNetCompiler.Debug = "True"
-		Release.AspNetCompiler.Debug = "False"
-	EndProjectSection
-	ProjectSection(SolutionItems) = preProject
-		Build.win32.readme = Build.win32.readme
-	EndProjectSection
-EndProject
 Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Enchant.Net", "..\src\bindings\Enchant.Net\Enchant.Net.csproj", "{249A514E-7212-485B-86D0-E0ACB8967A4C}"
-	ProjectSection(WebsiteProperties) = preProject
-		Debug.AspNetCompiler.Debug = "True"
-		Release.AspNetCompiler.Debug = "False"
-	EndProjectSection
	ProjectSection(ProjectDependencies) = postProject
		{E0DB6274-F44C-48E6-AE30-C00D59864569} = {E0DB6274-F44C-48E6-AE30-C00D59864569}
	EndProjectSection
 EndProject
 Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "Enchant.Net.Tests", "..\unittests\Enchant.Net.Tests\Enchant.Net.Tests.csproj", "{518F02B2-A542-44B3-A10D-CA8144268077}"
-	ProjectSection(WebsiteProperties) = preProject
-		Debug.AspNetCompiler.Debug = "True"
-		Release.AspNetCompiler.Debug = "False"
-	EndProjectSection
	ProjectSection(ProjectDependencies) = postProject
		{5DC9EE15-B080-4964-96CC-1BDC90BB873A} = {5DC9EE15-B080-4964-96CC-1BDC90BB873A}
		{70927F4C-0446-4EF3-9F65-FA78AC210506} = {70927F4C-0446-4EF3-9F65-FA78AC210506}
@@ -151,10 +83,6 @@
	EndProjectSection
 EndProject
 Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "unittest-providers", "unittest-providers.vcproj", "{B38EE40E-078C-427E-82BB-AC517B720F97}"
-	ProjectSection(WebsiteProperties) = preProject
-		Debug.AspNetCompiler.Debug = "True"
-		Release.AspNetCompiler.Debug = "False"
-	EndProjectSection
	ProjectSection(ProjectDependencies) = postProject
		{E948850F-C9DA-4824-876D-4FE97B88E79F} = {E948850F-C9DA-4824-876D-4FE97B88E79F}
		{5DC9EE15-B080-4964-96CC-1BDC90BB873A} = {5DC9EE15-B080-4964-96CC-1BDC90BB873A}
Index: msvc/enchant.vcproj
===================================================================
--- msvc/enchant.vcproj	(revision 29482)
+++ msvc/enchant.vcproj	(working copy)
@@ -1,11 +1,12 @@
 <?xml version="1.0" encoding="Windows-1252"?>
 <VisualStudioProject
	ProjectType="Visual C++"
-	Version="8.00"
+	Version="9.00"
	Name="enchant"
	ProjectGUID="{FE3CD71B-7742-46DD-AAE9-3CCAA110B4DB}"
	RootNamespace="enchant"
	Keyword="Win32Proj"
+	TargetFrameworkVersion="131072"
	>
	<Platforms>
		<Platform
@@ -66,6 +67,8 @@
				AdditionalLibraryDirectories="&quot;$(SolutionDir)..\lib\glib\$(ConfigurationName)&quot;"
				GenerateDebugInformation="true"
				SubSystem="1"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -87,9 +90,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
			/>
		</Configuration>
@@ -144,6 +144,8 @@
				SubSystem="1"
				OptimizeReferences="2"
				EnableCOMDATFolding="2"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -165,9 +167,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
			/>
		</Configuration>
Index: msvc/libenchant.vcproj
===================================================================
--- msvc/libenchant.vcproj	(revision 29482)
+++ msvc/libenchant.vcproj	(working copy)
@@ -1,11 +1,12 @@
 <?xml version="1.0" encoding="Windows-1252"?>
 <VisualStudioProject
	ProjectType="Visual C++"
-	Version="8.00"
+	Version="9.00"
	Name="libenchant"
	ProjectGUID="{E0DB6274-F44C-48E6-AE30-C00D59864569}"
	RootNamespace="enchant"
	Keyword="Win32Proj"
+	TargetFrameworkVersion="131072"
	>
	<Platforms>
		<Platform
@@ -24,7 +25,6 @@
			>
			<Tool
				Name="VCPreBuildEventTool"
-				Description=""
				CommandLine=""
			/>
			<Tool
@@ -43,7 +43,7 @@
				Name="VCCLCompilerTool"
				Optimization="0"
				AdditionalIncludeDirectories="&quot;$(SolutionDir)&quot;;&quot;$(SolutionDir)..\lib\glib\include\glib-2.0&quot;;&quot;$(SolutionDir)..\src&quot;;&quot;$(SolutionDir)..\lib\aspell&quot;;&quot;$(SolutionDir)..\lib\hspell&quot;;&quot;$(SolutionDir)..\lib\voikko&quot;;&quot;$(SolutionDir)..\lib&quot;;&quot;$(SolutionDir)..\lib\zemberek&quot;"
-				PreprocessorDefinitions="_ENCHANT_BUILD=1;_CRT_SECURE_NO_WARNINGS;_WIN32;_DEBUG;_WINDOWS"
+				PreprocessorDefinitions="ENCHANT_VERSION_STRING=\&quot;1.6\&quot;;_ENCHANT_BUILD=1;_CRT_SECURE_NO_WARNINGS;_WIN32;_DEBUG;_WINDOWS"
				MinimalRebuild="true"
				BasicRuntimeChecks="3"
				RuntimeLibrary="3"
@@ -63,11 +63,13 @@
			/>
			<Tool
				Name="VCLinkerTool"
-				AdditionalDependencies="glib-2.0-vs8.lib gmodule-2.0-vs8.lib"
+				AdditionalDependencies="glib-2.0-vs9.lib gmodule-2.0-vs9.lib"
				LinkIncremental="2"
				AdditionalLibraryDirectories="&quot;$(SolutionDir)..\lib\glib\$(ConfigurationName)&quot;"
				GenerateDebugInformation="true"
				SubSystem="2"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -89,9 +91,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
				Description="Copy dependencies"
				CommandLine="copy &quot;$(SolutionDir)..\lib\glib\$(ConfigurationName)\*.dll&quot; &quot;$(OutDir)\&quot;"
@@ -107,7 +106,6 @@
			>
			<Tool
				Name="VCPreBuildEventTool"
-				Description=""
				CommandLine=""
			/>
			<Tool
@@ -125,7 +123,7 @@
			<Tool
				Name="VCCLCompilerTool"
				AdditionalIncludeDirectories="&quot;$(SolutionDir)&quot;;&quot;$(SolutionDir)..\lib\glib\include\glib-2.0&quot;;&quot;$(SolutionDir)..\src&quot;;&quot;$(SolutionDir)..\lib\aspell&quot;;&quot;$(SolutionDir)..\lib\hspell&quot;;&quot;$(SolutionDir)..\lib\voikko&quot;;&quot;$(SolutionDir)..\lib&quot;;&quot;$(SolutionDir)..\lib\zemberek&quot;"
-				PreprocessorDefinitions="_ENCHANT_BUILD=1;_CRT_SECURE_NO_WARNINGS;_WIN32;NDEBUG;_WINDOWS"
+				PreprocessorDefinitions="ENCHANT_VERSION_STRING=\&quot;1.6\&quot;;_ENCHANT_BUILD=1;_CRT_SECURE_NO_WARNINGS;_WIN32;NDEBUG;_WINDOWS"
				RuntimeLibrary="2"
				UsePrecompiledHeader="0"
				WarningLevel="3"
@@ -143,13 +141,15 @@
			/>
			<Tool
				Name="VCLinkerTool"
-				AdditionalDependencies="glib-2.0-vs8.lib gmodule-2.0-vs8.lib"
+				AdditionalDependencies="glib-2.0-vs9.lib gmodule-2.0-vs9.lib"
				LinkIncremental="1"
				AdditionalLibraryDirectories="&quot;$(SolutionDir)..\lib\glib\$(ConfigurationName)&quot;"
				GenerateDebugInformation="true"
				SubSystem="2"
				OptimizeReferences="2"
				EnableCOMDATFolding="2"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -171,9 +171,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
				Description="Copy dependencies"
				CommandLine="copy &quot;$(SolutionDir)..\lib\glib\$(ConfigurationName)\*.dll&quot; &quot;$(OutDir)\&quot;"
Index: msvc/libenchant_aspell.vcproj
===================================================================
--- msvc/libenchant_aspell.vcproj	(revision 29482)
+++ msvc/libenchant_aspell.vcproj	(working copy)
@@ -1,11 +1,12 @@
 <?xml version="1.0" encoding="Windows-1252"?>
 <VisualStudioProject
	ProjectType="Visual C++"
-	Version="8.00"
+	Version="9.00"
	Name="libenchant_aspell"
	ProjectGUID="{E948850F-C9DA-4824-876D-4FE97B88E79F}"
	RootNamespace="aspell_provider"
	Keyword="Win32Proj"
+	TargetFrameworkVersion="131072"
	>
	<Platforms>
		<Platform
@@ -67,6 +68,8 @@
				DelayLoadDLLs="aspell-15.dll"
				GenerateDebugInformation="true"
				SubSystem="2"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -88,9 +91,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
			/>
		</Configuration>
@@ -138,7 +138,7 @@
			/>
			<Tool
				Name="VCLinkerTool"
-				AdditionalDependencies="glib-2.0-vs8.lib aspell-15.lib"
+				AdditionalDependencies="glib-2.0-vs9.lib aspell-15.lib"
				LinkIncremental="1"
				AdditionalLibraryDirectories="&quot;$(SolutionDir)..\lib\glib\$(ConfigurationName)&quot;;&quot;$(SolutionDir)..\lib\aspell\&quot;"
				DelayLoadDLLs="aspell-15.dll"
@@ -146,6 +146,8 @@
				SubSystem="2"
				OptimizeReferences="2"
				EnableCOMDATFolding="2"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -167,9 +169,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
			/>
		</Configuration>
Index: msvc/libenchant_hspell.vcproj
===================================================================
--- msvc/libenchant_hspell.vcproj	(revision 29482)
+++ msvc/libenchant_hspell.vcproj	(working copy)
@@ -1,11 +1,12 @@
 <?xml version="1.0" encoding="Windows-1252"?>
 <VisualStudioProject
	ProjectType="Visual C++"
-	Version="8.00"
+	Version="9.00"
	Name="libenchant_hspell"
	ProjectGUID="{AA6839DF-19CB-49DD-8258-ABB86B5B0428}"
	RootNamespace="hspell_provider"
	Keyword="Win32Proj"
+	TargetFrameworkVersion="131072"
	>
	<Platforms>
		<Platform
@@ -66,6 +67,8 @@
				AdditionalLibraryDirectories="&quot;$(SolutionDir)..\lib\glib\$(ConfigurationName)&quot;"
				GenerateDebugInformation="true"
				SubSystem="2"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -87,9 +90,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
			/>
		</Configuration>
@@ -144,6 +144,8 @@
				SubSystem="2"
				OptimizeReferences="2"
				EnableCOMDATFolding="2"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -165,9 +167,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
			/>
		</Configuration>
Index: msvc/libenchant_ispell.vcproj
===================================================================
--- msvc/libenchant_ispell.vcproj	(revision 29482)
+++ msvc/libenchant_ispell.vcproj	(working copy)
@@ -1,11 +1,12 @@
 <?xml version="1.0" encoding="Windows-1252"?>
 <VisualStudioProject
	ProjectType="Visual C++"
-	Version="8.00"
+	Version="9.00"
	Name="libenchant_ispell"
	ProjectGUID="{5DC9EE15-B080-4964-96CC-1BDC90BB873A}"
	RootNamespace="ispell_provider"
	Keyword="Win32Proj"
+	TargetFrameworkVersion="131072"
	>
	<Platforms>
		<Platform
@@ -66,6 +67,8 @@
				AdditionalLibraryDirectories="&quot;$(SolutionDir)..\lib\glib\$(ConfigurationName)&quot;"
				GenerateDebugInformation="true"
				SubSystem="2"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -87,9 +90,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
			/>
		</Configuration>
@@ -137,13 +137,15 @@
			/>
			<Tool
				Name="VCLinkerTool"
-				AdditionalDependencies="glib-2.0-vs8.lib "
+				AdditionalDependencies="glib-2.0-vs9.lib "
				LinkIncremental="1"
				AdditionalLibraryDirectories="&quot;$(SolutionDir)..\lib\glib\$(ConfigurationName)&quot;"
				GenerateDebugInformation="true"
				SubSystem="2"
				OptimizeReferences="2"
				EnableCOMDATFolding="2"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -165,9 +167,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
			/>
		</Configuration>
@@ -240,6 +239,10 @@
			Filter="rc;ico;cur;bmp;dlg;rc2;rct;bin;rgs;gif;jpg;jpeg;jpe;resx;tiff;tif;png;wav"
			UniqueIdentifier="{67DA6AB6-F800-4c08-8B7A-83BB121AAD01}"
			>
+			<File
+				RelativePath="..\src\ispell\libenchant_ispell.rc"
+				>
+			</File>
		</Filter>
		<File
			RelativePath="..\src\ispell\README"
Index: msvc/libenchant_mock_provider.vcproj
===================================================================
--- msvc/libenchant_mock_provider.vcproj	(revision 29482)
+++ msvc/libenchant_mock_provider.vcproj	(working copy)
@@ -1,11 +1,12 @@
 <?xml version="1.0" encoding="Windows-1252"?>
 <VisualStudioProject
	ProjectType="Visual C++"
-	Version="8.00"
+	Version="9.00"
	Name="libenchant_mock_provider"
	ProjectGUID="{A8F1C09A-A244-441B-804C-635106305056}"
	RootNamespace="libenchant_mock_provider"
	Keyword="Win32Proj"
+	TargetFrameworkVersion="131072"
	>
	<Platforms>
		<Platform
@@ -66,6 +67,8 @@
				AdditionalLibraryDirectories="&quot;$(SolutionDir)..\lib\glib\$(ConfigurationName)&quot;"
				GenerateDebugInformation="true"
				SubSystem="1"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -87,9 +90,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
			/>
		</Configuration>
@@ -137,13 +137,15 @@
			/>
			<Tool
				Name="VCLinkerTool"
-				AdditionalDependencies="glib-2.0-vs8.lib"
+				AdditionalDependencies="glib-2.0-vs9.lib"
				LinkIncremental="1"
				AdditionalLibraryDirectories="&quot;$(SolutionDir)..\lib\glib\$(ConfigurationName)&quot;"
				GenerateDebugInformation="true"
				SubSystem="1"
				OptimizeReferences="2"
				EnableCOMDATFolding="2"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -165,9 +167,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
			/>
		</Configuration>
Index: msvc/libenchant_myspell.vcproj
===================================================================
--- msvc/libenchant_myspell.vcproj	(revision 29482)
+++ msvc/libenchant_myspell.vcproj	(working copy)
@@ -1,11 +1,12 @@
 <?xml version="1.0" encoding="Windows-1252"?>
 <VisualStudioProject
	ProjectType="Visual C++"
-	Version="8.00"
+	Version="9.00"
	Name="libenchant_myspell"
	ProjectGUID="{70927F4C-0446-4EF3-9F65-FA78AC210506}"
	RootNamespace="myspell_provider"
	Keyword="Win32Proj"
+	TargetFrameworkVersion="131072"
	>
	<Platforms>
		<Platform
@@ -66,6 +67,8 @@
				AdditionalLibraryDirectories="&quot;$(SolutionDir)..\lib\glib\$(ConfigurationName)&quot;"
				GenerateDebugInformation="true"
				SubSystem="2"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -87,9 +90,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
			/>
		</Configuration>
@@ -137,13 +137,15 @@
			/>
			<Tool
				Name="VCLinkerTool"
-				AdditionalDependencies="glib-2.0-vs8.lib "
+				AdditionalDependencies="glib-2.0-vs9.lib "
				LinkIncremental="1"
				AdditionalLibraryDirectories="&quot;$(SolutionDir)..\lib\glib\$(ConfigurationName)&quot;"
				GenerateDebugInformation="true"
				SubSystem="2"
				OptimizeReferences="2"
				EnableCOMDATFolding="2"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -165,9 +167,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
			/>
		</Configuration>
@@ -312,6 +311,10 @@
			Filter="rc;ico;cur;bmp;dlg;rc2;rct;bin;rgs;gif;jpg;jpeg;jpe;resx;tiff;tif;png;wav"
			UniqueIdentifier="{67DA6AB6-F800-4c08-8B7A-83BB121AAD01}"
			>
+			<File
+				RelativePath="..\src\myspell\libenchant_myspell.rc"
+				>
+			</File>
		</Filter>
		<File
			RelativePath="..\src\myspell\license.hunspell"
Index: msvc/libenchant_uspell.vcproj
===================================================================
--- msvc/libenchant_uspell.vcproj	(revision 29482)
+++ msvc/libenchant_uspell.vcproj	(working copy)
@@ -1,11 +1,12 @@
 <?xml version="1.0" encoding="Windows-1252"?>
 <VisualStudioProject
	ProjectType="Visual C++"
-	Version="8.00"
+	Version="9.00"
	Name="libenchant_uspell"
	ProjectGUID="{6FA58A42-075E-4671-BBB4-F7AA8061F839}"
	RootNamespace="uspell_provider"
	Keyword="Win32Proj"
+	TargetFrameworkVersion="131072"
	>
	<Platforms>
		<Platform
@@ -66,6 +67,8 @@
				AdditionalLibraryDirectories="&quot;$(SolutionDir)..\lib\glib\$(ConfigurationName)&quot;"
				GenerateDebugInformation="true"
				SubSystem="2"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -87,9 +90,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
			/>
		</Configuration>
@@ -144,6 +144,8 @@
				SubSystem="2"
				OptimizeReferences="2"
				EnableCOMDATFolding="2"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -165,9 +167,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
			/>
		</Configuration>
Index: msvc/libenchant_voikko.vcproj
===================================================================
--- msvc/libenchant_voikko.vcproj	(revision 29482)
+++ msvc/libenchant_voikko.vcproj	(working copy)
@@ -1,11 +1,12 @@
 <?xml version="1.0" encoding="Windows-1252"?>
 <VisualStudioProject
	ProjectType="Visual C++"
-	Version="8.00"
+	Version="9.00"
	Name="libenchant_voikko"
	ProjectGUID="{5612C360-309B-4E73-8512-6A1265590B90}"
	RootNamespace="voikko_provider"
	Keyword="Win32Proj"
+	TargetFrameworkVersion="131072"
	>
	<Platforms>
		<Platform
@@ -66,6 +67,8 @@
				AdditionalLibraryDirectories="&quot;$(SolutionDir)..\lib\glib\$(ConfigurationName)&quot;"
				GenerateDebugInformation="true"
				SubSystem="2"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -87,9 +90,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
			/>
		</Configuration>
@@ -144,6 +144,8 @@
				SubSystem="2"
				OptimizeReferences="2"
				EnableCOMDATFolding="2"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -165,9 +167,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
			/>
		</Configuration>
Index: msvc/libenchant_zemberek.vcproj
===================================================================
--- msvc/libenchant_zemberek.vcproj	(revision 29482)
+++ msvc/libenchant_zemberek.vcproj	(working copy)
@@ -1,11 +1,12 @@
 <?xml version="1.0" encoding="Windows-1252"?>
 <VisualStudioProject
	ProjectType="Visual C++"
-	Version="8.00"
+	Version="9.00"
	Name="libenchant_zemberek"
	ProjectGUID="{B35929B8-374C-442B-A0F5-494AD69EDE1A}"
	RootNamespace="zemberek_provider"
	Keyword="Win32Proj"
+	TargetFrameworkVersion="131072"
	>
	<Platforms>
		<Platform
@@ -66,6 +67,8 @@
				AdditionalLibraryDirectories="&quot;$(SolutionDir)..\lib\glib\$(ConfigurationName)&quot;"
				GenerateDebugInformation="true"
				SubSystem="2"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -87,9 +90,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
			/>
		</Configuration>
@@ -144,6 +144,8 @@
				SubSystem="2"
				OptimizeReferences="2"
				EnableCOMDATFolding="2"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -165,9 +167,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
			/>
		</Configuration>
Index: msvc/test-enchant.vcproj
===================================================================
--- msvc/test-enchant.vcproj	(revision 29482)
+++ msvc/test-enchant.vcproj	(working copy)
@@ -1,11 +1,12 @@
 <?xml version="1.0" encoding="Windows-1252"?>
 <VisualStudioProject
	ProjectType="Visual C++"
-	Version="8.00"
+	Version="9.00"
	Name="test-enchant"
	ProjectGUID="{3CC7AE6D-FEA3-4EB3-98FA-8AB038541411}"
	RootNamespace="testenchant"
	Keyword="Win32Proj"
+	TargetFrameworkVersion="131072"
	>
	<Platforms>
		<Platform
@@ -64,6 +65,8 @@
				LinkIncremental="2"
				GenerateDebugInformation="true"
				SubSystem="1"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -85,9 +88,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
				Description="Copy Test Personal Word List"
				CommandLine="copy &quot;$(SolutionDir)..\tests\test.pwl&quot; &quot;$(OutDir)&quot;"
@@ -142,6 +142,8 @@
				SubSystem="1"
				OptimizeReferences="2"
				EnableCOMDATFolding="2"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -163,9 +165,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
			/>
		</Configuration>
Index: msvc/test-enchantxx.vcproj
===================================================================
--- msvc/test-enchantxx.vcproj	(revision 29482)
+++ msvc/test-enchantxx.vcproj	(working copy)
@@ -1,11 +1,12 @@
 <?xml version="1.0" encoding="Windows-1252"?>
 <VisualStudioProject
	ProjectType="Visual C++"
-	Version="8.00"
+	Version="9.00"
	Name="test-enchantxx"
	ProjectGUID="{001DB089-3C83-4384-BB2B-1FE37D091B04}"
	RootNamespace="testenchantxx"
	Keyword="Win32Proj"
+	TargetFrameworkVersion="131072"
	>
	<Platforms>
		<Platform
@@ -66,6 +67,8 @@
				LinkIncremental="2"
				GenerateDebugInformation="true"
				SubSystem="1"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -87,9 +90,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
			/>
		</Configuration>
@@ -142,6 +142,8 @@
				SubSystem="1"
				OptimizeReferences="2"
				EnableCOMDATFolding="2"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -163,9 +165,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
			/>
		</Configuration>
Index: msvc/unittest-enchant.vcproj
===================================================================
--- msvc/unittest-enchant.vcproj	(revision 29482)
+++ msvc/unittest-enchant.vcproj	(working copy)
@@ -1,11 +1,12 @@
 <?xml version="1.0" encoding="Windows-1252"?>
 <VisualStudioProject
	ProjectType="Visual C++"
-	Version="8.00"
+	Version="9.00"
	Name="unittest-enchant"
	ProjectGUID="{44BF74D0-5462-4A3B-8768-61E0DEF81B7B}"
	RootNamespace="unittest-enchant"
	Keyword="Win32Proj"
+	TargetFrameworkVersion="131072"
	>
	<Platforms>
		<Platform
@@ -67,6 +68,8 @@
				AdditionalLibraryDirectories="&quot;$(SolutionDir)..\lib\glib\$(ConfigurationName)&quot;; &quot;$(SolutionDir)..\lib\UnitTest++\$(ConfigurationName)&quot;"
				GenerateDebugInformation="true"
				SubSystem="1"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -88,9 +91,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
				Description="Run All Tests"
				CommandLine="&quot;$(TargetPath)&quot;"
@@ -122,7 +122,7 @@
			/>
			<Tool
				Name="VCCLCompilerTool"
-				AdditionalIncludeDirectories="&quot;$(SolutionDir)..\lib\UnitTest++\src&quot;;&quot;$(SolutionDir)..\lib\glib\include\glib-2.0&quot;;&quot;$(SolutionDir)..\src&quot;;"
+				AdditionalIncludeDirectories="&quot;$(SolutionDir)..\lib\UnitTest++\src&quot;;&quot;$(SolutionDir)..\lib\glib\include\glib-2.0\glib&quot;;&quot;$(SolutionDir)..\lib\glib\include\glib-2.0&quot;;&quot;$(SolutionDir)..\src&quot;"
				PreprocessorDefinitions="VERSION=\&quot;1.3.1\&quot;;WIN32;NDEBUG;_CONSOLE"
				RuntimeLibrary="2"
				UsePrecompiledHeader="0"
@@ -141,13 +141,15 @@
			/>
			<Tool
				Name="VCLinkerTool"
-				AdditionalDependencies="glib-2.0-vs8.lib UnitTest++.vsnet2005.lib shlwapi.lib"
+				AdditionalDependencies="glib-2.0-vs9.lib  UnitTest++.vsnet2005.lib shlwapi.lib"
				LinkIncremental="1"
				AdditionalLibraryDirectories="&quot;$(SolutionDir)..\lib\glib\$(ConfigurationName)&quot;; &quot;$(SolutionDir)..\lib\UnitTest++\$(ConfigurationName)&quot;"
				GenerateDebugInformation="true"
				SubSystem="1"
				OptimizeReferences="2"
				EnableCOMDATFolding="2"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -169,9 +171,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
				Description="Run All Tests"
				CommandLine="&quot;$(TargetPath)&quot;&#x0D;&#x0A;"
Index: msvc/unittest-providers.vcproj
===================================================================
--- msvc/unittest-providers.vcproj	(revision 29482)
+++ msvc/unittest-providers.vcproj	(working copy)
@@ -1,11 +1,12 @@
 <?xml version="1.0" encoding="Windows-1252"?>
 <VisualStudioProject
	ProjectType="Visual C++"
-	Version="8.00"
+	Version="9.00"
	Name="unittest-providers"
	ProjectGUID="{B38EE40E-078C-427E-82BB-AC517B720F97}"
	RootNamespace="unittest-providers"
	Keyword="Win32Proj"
+	TargetFrameworkVersion="131072"
	>
	<Platforms>
		<Platform
@@ -68,6 +69,8 @@
				AdditionalLibraryDirectories="&quot;$(SolutionDir)..\lib\glib\$(ConfigurationName)&quot;; &quot;$(SolutionDir)..\lib\UnitTest++\$(ConfigurationName)&quot;"
				GenerateDebugInformation="true"
				SubSystem="1"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -89,9 +92,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
				Description="Run All Tests"
				CommandLine="&quot;$(TargetPath)&quot; &quot;$(OutDir)&quot;"
@@ -150,6 +150,8 @@
				SubSystem="1"
				OptimizeReferences="2"
				EnableCOMDATFolding="2"
+				RandomizedBaseAddress="1"
+				DataExecutionPrevention="0"
				TargetMachine="1"
			/>
			<Tool
@@ -171,9 +173,6 @@
				Name="VCAppVerifierTool"
			/>
			<Tool
-				Name="VCWebDeploymentTool"
-			/>
-			<Tool
				Name="VCPostBuildEventTool"
				Description="Run All Tests"
				CommandLine="&quot;$(TargetPath)&quot; &quot;$(OutDir)&quot;"
Index: src/bindings/Enchant.Net/Enchant.Net.csproj
===================================================================
--- src/bindings/Enchant.Net/Enchant.Net.csproj	(revision 29482)
+++ src/bindings/Enchant.Net/Enchant.Net.csproj	(working copy)
@@ -1,4 +1,4 @@
-﻿<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+﻿<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003" ToolsVersion="3.5">
   <PropertyGroup>
     <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
     <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
@@ -10,6 +10,11 @@
     <RootNamespace>Enchant</RootNamespace>
     <AssemblyName>Enchant.Net</AssemblyName>
     <RunPostBuildEvent>Always</RunPostBuildEvent>
+    <FileUpgradeFlags>
+    </FileUpgradeFlags>
+    <OldToolsVersion>2.0</OldToolsVersion>
+    <UpgradeBackupLocation>
+    </UpgradeBackupLocation>
   </PropertyGroup>
   <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
     <DebugSymbols>true</DebugSymbols>
Index: src/myspell/libenchant_myspell.rc
===================================================================
--- src/myspell/libenchant_myspell.rc	(revision 29930)
+++ src/myspell/libenchant_myspell.rc	(working copy)
@@ -2,8 +2,8 @@
 LANGUAGE 0, 0
 
 10 VERSIONINFO
- FILEVERSION 1,0,0,1
- PRODUCTVERSION 1,0,0,1
+ FILEVERSION 1,6,2,0
+ PRODUCTVERSION 1,6,2,0
  FILEFLAGSMASK 0x3fL
 #ifdef _DEBUG
  FILEFLAGS 0x1L
@@ -20,14 +20,14 @@
         BEGIN
             VALUE "CompanyName", "\0"
             VALUE "FileDescription", "Libenchant Myspell module\0"
-            VALUE "FileVersion", "1, 7, 0, 1\0"
-            VALUE "InternalName", "libenchant_myspell\0"
+            VALUE "FileVersion", "1, 6, 2, 0\0"
+            VALUE "InternalName", "libenchant_myspell-1.6\0"
             VALUE "LegalCopyright", "Copyright \xA9 2003-2011 Joan Moratinos, Dom Lachowicz et al.\0"
             VALUE "LegalTrademarks", "\0"
-            VALUE "OriginalFilename", "libenchant_myspell.dll\0"
+            VALUE "OriginalFilename", "libenchant_myspell-1.6.dll\0"
             VALUE "PrivateBuild", "Dev version\0"
             VALUE "ProductName", "libenchant\0"
-            VALUE "ProductVersion", "1, 7, 0\0"
+            VALUE "ProductVersion", "1, 6, 2\0"
         END
     END
     BLOCK "VarFileInfo"
Index: unittests/Enchant.Net.Tests/Enchant.Net.Tests.csproj
===================================================================
--- unittests/Enchant.Net.Tests/Enchant.Net.Tests.csproj	(revision 29482)
+++ unittests/Enchant.Net.Tests/Enchant.Net.Tests.csproj	(working copy)
@@ -1,4 +1,4 @@
-﻿<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
+﻿<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003" ToolsVersion="3.5">
   <PropertyGroup>
     <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
     <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
@@ -9,6 +9,11 @@
     <AppDesignerFolder>Properties</AppDesignerFolder>
     <RootNamespace>Enchant.Tests</RootNamespace>
     <AssemblyName>Enchant.Net.Tests</AssemblyName>
+    <FileUpgradeFlags>
+    </FileUpgradeFlags>
+    <OldToolsVersion>2.0</OldToolsVersion>
+    <UpgradeBackupLocation>
+    </UpgradeBackupLocation>
   </PropertyGroup>
   <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
     <DebugSymbols>true</DebugSymbols>
Index: unittests/EnchantBrokerTestFixture.h
===================================================================
--- unittests/EnchantBrokerTestFixture.h	(revision 29482)
+++ unittests/EnchantBrokerTestFixture.h	(working copy)
@@ -41,6 +41,7 @@
 #endif
 #endif

+#define testResults_ (*(UnitTest::CurrentTest::Results()))
 //////////////////////////////////////
 // Mock provider functions
 static void
Index: unittests/EnchantTestFixture.h
===================================================================
--- unittests/EnchantTestFixture.h	(revision 29482)
+++ unittests/EnchantTestFixture.h	(working copy)
@@ -34,6 +34,7 @@
 #include <io.h>
 #include <assert.h>
 #include <glib.h>
+#include <gstdio.h>
 #include <string>

 struct EnchantTestFixture
