<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003" ToolsVersion="4.0">
	<PropertyGroup Condition="'$(OS)'=='Unix'">
		<platformSource>Linux</platformSource>
	</PropertyGroup>
	<PropertyGroup Condition="'$(OS)'=='Windows_NT'">
		<platformSource>Windows</platformSource>
	</PropertyGroup>
	<!-- this list may be overkill for any one project, but let's keep things simple -->
	<ItemGroup>
		<PalasoDllFiles Include="Palaso.dll"/>
		<PalasoDllFiles Include="Palaso.Lift.dll"/>
		<PalasoDllFiles Include="Palaso.Media.dll"/>
	</ItemGroup>
	<ItemGroup>
		<PalasoFilesSource Include="@(PalasoDllFiles -> '$(DistFiles)/$(platformSource)/%(Identity)')"/>
	</ItemGroup>

	<Target Name="CopyPalasoDlls">
		<Copy SourceFiles="@(PalasoFilesSource)" DestinationFolder="$(OutDir)" OverwriteReadOnlyFiles="true" SkipUnchangedFiles="true"/>
	</Target>

	<ItemGroup>
		<PalasoOutputFiles Include="@(PalasoDllFiles -> '$(OutDir)/%(Identity)')"/>
	</ItemGroup>
	<Target Name="DeleteCopiedPalasoDlls">
		<Delete Files="@(PalasoOutputFiles)" ContinueOnError="true"/>
	</Target>

	<!-- These targets can be overridden by a BuildIncludes.targets -->
	<Target Name="BeforeBuild" DependsOnTargets="CopyPalasoDlls"/>
	<Target Name="AfterClean" DependsOnTargets="DeleteCopiedPalasoDlls"/>

</Project>
